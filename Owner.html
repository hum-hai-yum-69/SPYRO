<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ParkFast Owner</title>

<style>

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:Arial, Helvetica, sans-serif;
}

body{
background:#f4f6f9;
}

/* NAVBAR */

.nav{
background:#1f2937;
height:60px;
display:flex;
align-items:center;
justify-content:space-between;
padding:0 20px;
color:white;
}

.nav-left{
display:flex;
align-items:center;
gap:12px;
}

.profile{
width:42px;
height:42px;
border-radius:50%;
overflow:hidden;
background:white;
}

.profile img{
width:100%;
height:100%;
object-fit:cover;
}

.nav-right{
display:flex;
gap:15px;
}

.nav-right button{
background:none;
border:none;
color:white;
cursor:pointer;
padding:6px 10px;
border-radius:6px;
}

.nav-right button:hover{
background:#374151;
}

/* CONTAINER */

.container{
padding:20px;
max-width:1200px;
margin:auto;
}

/* SUMMARY CARDS */

.cards{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
gap:20px;
margin-bottom:30px;
}

.card{
background:white;
padding:20px;
border-radius:10px;
box-shadow:0 5px 15px rgba(0,0,0,0.08);
}

.card h3{
margin-bottom:8px;
color:#2d8cff;
}

/* LOCATION CARDS */

.location-cards{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
gap:20px;
}

.location-card{
background:white;
padding:20px;
border-radius:12px;
box-shadow:0 5px 15px rgba(0,0,0,0.08);
cursor:pointer;
}

/* MODAL */

.modal{
display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.5);
justify-content:center;
align-items:center;
}

.modal-content{
background:white;
padding:25px;
border-radius:12px;
width:350px;
}

.modal-content input{
width:100%;
padding:8px;
margin:6px 0;
}

.modal-content button{
width:100%;
padding:10px;
background:#2d8cff;
border:none;
color:white;
cursor:pointer;
}

</style>
</head>

<body>

<div class="nav">
<div class="nav-left">
<div class="profile">
<img src="carparking.jpeg">
</div>
<div>ParkFast Owner</div>
</div>

<div class="nav-right">
<button onclick="openModal()">Add Parking</button>
<button>Logout</button>
</div>
</div>

<div class="container">

<h2>Welcome, Owner ðŸ‘‹</h2>

<div class="cards">

<div class="card">
<h3>Total Locations</h3>
<p id="totalLocations">0</p>
</div>

<div class="card">
<h3>Total Slots</h3>
<p id="totalSlots">0</p>
</div>

<div class="card">
<h3>Total Earnings</h3>
<p id="totalEarnings">â‚¹0</p>
</div>

</div>

<h3>Your Parking Locations</h3>
<div class="location-cards" id="locationCards"></div>

</div>

<!-- MODAL -->

<div class="modal" id="parkingModal">
<div class="modal-content">

<h3>Add Parking Location</h3>

<input id="companyName" placeholder="Company Name">
<input id="ownerName" placeholder="Owner Name">
<input id="locationName" placeholder="Location Name">
<input id="address" placeholder="Address">
<input id="totalSlotInput" type="number" placeholder="Total Slots">
<input id="bikePrice" placeholder="Bike Price">
<input id="carPrice" placeholder="Car Price">
<input id="truckPrice" placeholder="Truck Price">

<button onclick="addParking()">Create Parking</button>

</div>
</div>


<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, set, onValue }
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
apiKey:"AIzaSyAkbz_WM6KT56g1awB-TviU8Uo1svrivJw",
authDomain:"carparkingapp-9267e.firebaseapp.com",
databaseURL:"https://carparkingapp-9267e-default-rtdb.firebaseio.com/",
projectId:"carparkingapp-9267e"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const locationRef = ref(db,"parkingLocations");


// OPEN MODAL

window.openModal = () => {
document.getElementById("parkingModal").style.display="flex";
};


// CLOSE MODAL

window.onclick = (e) => {
if(e.target.id === "parkingModal"){
document.getElementById("parkingModal").style.display="none";
}
};


// ADD PARKING

window.addParking = () => {

const company = document.getElementById("companyName").value;
const owner = document.getElementById("ownerName").value;
const name = document.getElementById("locationName").value;
const addressVal = document.getElementById("address").value;
const totalSlots = Number(document.getElementById("totalSlotInput").value);
const bike = Number(document.getElementById("bikePrice").value);
const car = Number(document.getElementById("carPrice").value);
const truck = Number(document.getElementById("truckPrice").value);

if(!company || !name || !totalSlots){
alert("Please fill required fields");
return;
}

const newLocationRef = push(locationRef);

set(newLocationRef,{
company,
owner,
name,
address:addressVal,
totalSlots,
availableSlots:totalSlots,
prices:{bike,car,truck},
earnings:0,
createdAt:Date.now()
});

document.getElementById("parkingModal").style.display="none";
};


// LOAD DATA LIVE

onValue(locationRef,(snapshot)=>{

const container = document.getElementById("locationCards");
container.innerHTML="";

let totalLocations = 0;
let totalSlots = 0;
let totalEarnings = 0;

if(snapshot.exists()){

Object.entries(snapshot.val()).forEach(([id,loc])=>{

totalLocations++;
totalSlots += loc.totalSlots;
totalEarnings += loc.earnings || 0;

const card = document.createElement("div");
card.className="location-card";

card.innerHTML = `
<h3>${loc.name}</h3>
<p><strong>Company:</strong> ${loc.company}</p>
<p><strong>Owner:</strong> ${loc.owner}</p>
<p><strong>Slots:</strong> ${loc.availableSlots}/${loc.totalSlots}</p>
<p><strong>Prices:</strong> Bike â‚¹${loc.prices.bike} | Car â‚¹${loc.prices.car} | Truck â‚¹${loc.prices.truck}</p>
<p><strong>Earnings:</strong> â‚¹${loc.earnings || 0}</p>
`;

card.onclick = () => {
localStorage.setItem("selectedLocationID", id);
window.location.href="locationAn.html";
};

container.appendChild(card);

});

}

document.getElementById("totalLocations").innerText = totalLocations;
document.getElementById("totalSlots").innerText = totalSlots;
document.getElementById("totalEarnings").innerText = "â‚¹"+totalEarnings;

});

</script>

</body>
</html>
